<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Hall of Masters</title>
    <style>
        body { background: #161512; color: #fff; font-family: sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { display: flex; gap: 40px; flex-wrap: wrap; justify-content: center; }
        .board-wrapper { width: 480px; height: 480px; border: 10px solid #3d2d1e; background: #2b2b2b; position: relative; }
        #painel { width: 280px; background: #262421; padding: 20px; border-radius: 12px; display: flex; flex-direction: column; align-items: center; border: 1px solid #444; }
        #foto-mestre { width: 200px; height: 200px; border-radius: 8px; border: 3px solid #c3a000; margin-bottom: 20px; object-fit: cover; }
        .nome-mestre { color: #ffd700; font-size: 1.8em; font-weight: bold; margin-bottom: 25px; text-align: center; }
        .btn { width: 100%; padding: 20px; background: #c3a000; color: #000; border: none; font-weight: bold; cursor: pointer; border-radius: 8px; font-size: 1.1em; }
        
        /* CSS Essencial do Chessground */
        #chess-board { width: 100%; height: 100%; }
        .cg-wrap { position: relative; width: 100%; height: 100%; display: block; }
        cg-helper { position: absolute; width: 100%; padding-bottom: 100%; display: block; }
        cg-container { position: absolute; width: 100%; height: 100%; display: block; }
        cg-board { position: absolute; width: 100%; height: 100%; display: block; cursor: pointer; background-size: cover; }
        piece { position: absolute; width: 12.5%; height: 12.5%; background-size: cover; z-index: 2; pointer-events: none; }
        square { position: absolute; width: 12.5%; height: 12.5%; z-index: 1; }
        
        /* Cores do Tabuleiro (Blue) */
        .blue .square.light { background-color: #dee3e6; }
        .blue .square.dark { background-color: #8ca2ad; }

        /* Peças do Lichess */
        .piece.pawn.white { background-image: url('https://lichess1.org/assets/piece/alpha/wP.svg'); }
        .piece.knight.white { background-image: url('https://lichess1.org/assets/piece/alpha/wN.svg'); }
        .piece.bishop.white { background-image: url('https://lichess1.org/assets/piece/alpha/wB.svg'); }
        .piece.rook.white { background-image: url('https://lichess1.org/assets/piece/alpha/wR.svg'); }
        .piece.queen.white { background-image: url('https://lichess1.org/assets/piece/alpha/wQ.svg'); }
        .piece.king.white { background-image: url('https://lichess1.org/assets/piece/alpha/wK.svg'); }
        .piece.pawn.black { background-image: url('https://lichess1.org/assets/piece/alpha/bP.svg'); }
        .piece.knight.black { background-image: url('https://lichess1.org/assets/piece/alpha/bN.svg'); }
        .piece.bishop.black { background-image: url('https://lichess1.org/assets/piece/alpha/bB.svg'); }
        .piece.rook.black { background-image: url('https://lichess1.org/assets/piece/alpha/bR.svg'); }
        .piece.queen.black { background-image: url('https://lichess1.org/assets/piece/alpha/bQ.svg'); }
        .piece.king.black { background-image: url('https://lichess1.org/assets/piece/alpha/bK.svg'); }
    </style>
</head>
<body>

<div class="container">
    <div class="board-wrapper">
        <div id="chess-board" class="blue"></div>
    </div>

    <div id="painel">
        <img id="foto-mestre" src="Tal.jpg" alt="Mestre">
        <div class="nome-mestre" id="nome-mestre">MIKHAIL TAL</div>
        <button class="btn" id="btn-sorteio">Desafiar Mestre</button>
    </div>
</div>

<script src="chess.min.js"></script>
<script src="chessground.min.js"></script>

<script>
    window.onload = function() {
        const chess = new Chess();
        const boardNode = document.getElementById('chess-board');
        
        const cg = Chessground(boardNode, {
            movable: { 
                free: false, 
                color: 'white', 
                dests: getDests() 
            },
            drawable: { enabled: true }
        });

        function getDests() {
            const dests = new Map();
            chess.SQUARES.forEach(s => {
                const ms = chess.moves({ square: s, verbose: true });
                if (ms.length) dests.set(s, ms.map(m => m.to));
            });
            return dests;
        }

        const mestres = ["Anand", "Capablanca", "Carlsen", "Fischer", "Karpov", "Keres", "Lasker", "Marshall", "Polgar", "Rubinstein", "Tal"];
        
        document.getElementById('btn-sorteio').onclick = function() {
            const mestreSorteado = mestres[Math.floor(Math.random() * mestres.length)];
            document.getElementById('nome-mestre').innerText = mestreSorteado.toUpperCase();
            
            // As fotos estão na raiz, então o caminho é direto
            document.getElementById('foto-mestre').src = mestreSorteado + ".jpg";
            
            chess.reset();
            cg.set({ fen: chess.fen(), lastMove: null });
        };

        // Redesenhar para garantir que as dimensões estão corretas
        setTimeout(() => { cg.redrawAll(); }, 200);
    };
</script>
</body>
</html>